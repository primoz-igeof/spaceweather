<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Weather Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        header {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        h1 {
            font-size: 36px;
            color: #1e293b;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 16px;
            color: #64748b;
        }
        
        .update-info {
            margin-top: 15px;
            padding: 10px;
            background: #f1f5f9;
            border-radius: 6px;
            font-size: 14px;
            color: #475569;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .card h2 {
            font-size: 20px;
            color: #1e293b;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .card-full {
            grid-column: 1 / -1;
        }
        
        .image-container {
            width: 100%;
            text-align: center;
            margin-top: 15px;
        }
        
        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .chart-container {
            width: 100%;
            height: 500px;
            margin-top: 15px;
        }
        
        .info-text {
            font-size: 14px;
            color: #64748b;
            line-height: 1.6;
            margin-top: 10px;
        }
        
        .refresh-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
            transition: background 0.2s;
        }
        
        .refresh-btn:hover {
            background: #2563eb;
        }
        
        .refresh-btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .spinning {
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        
        .aurora-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .aurora-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .legend {
            background: #f8fafc;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            font-size: 13px;
            color: #475569;
        }
        
        .legend h4 {
            margin-bottom: 8px;
            color: #1e293b;
        }
        
        footer {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            font-size: 14px;
            color: #64748b;
        }
        
        footer a {
            color: #3b82f6;
            text-decoration: none;
        }
        
        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåå Space Weather Dashboard</h1>
            <p class="subtitle">Real-time monitoring of solar activity, geomagnetic conditions, and auroral forecasts</p>
            <div class="update-info" id="lastUpdate">Loading data...</div>
        </header>

        <div class="grid">
            <!-- GOES X-ray Flux -->
            <div class="card card-full">
                <h2>‚ö° GOES X-ray Flux (6 Hour)</h2>
                <div class="chart-container" id="xrayChart"></div>
                <div class="legend">
                    <h4>Solar Flare Classes:</h4>
                    <strong>X:</strong> ‚â• 10‚Åª‚Å¥ W/m¬≤ (Extreme) ‚Ä¢ 
                    <strong>M:</strong> 10‚Åª‚Åµ W/m¬≤ (Strong) ‚Ä¢ 
                    <strong>C:</strong> 10‚Åª‚Å∂ W/m¬≤ (Moderate) ‚Ä¢ 
                    <strong>B:</strong> 10‚Åª‚Å∑ W/m¬≤ (Small) ‚Ä¢ 
                    <strong>A:</strong> &lt; 10‚Åª‚Å∑ W/m¬≤ (Background)
                </div>
                <button class="refresh-btn" onclick="loadXrayData()">‚Üª Refresh X-ray Data</button>
            </div>

            <!-- Aurora Forecast -->
            <div class="card">
                <h2>üå† Aurora 30-Minute Forecast</h2>
                <div class="aurora-grid">
                    <div class="image-container">
                        <h3 style="font-size: 16px; margin-bottom: 10px;">Northern Hemisphere</h3>
                        <img id="auroraNorth" src="https://services.swpc.noaa.gov/images/aurora-forecast-northern-hemisphere.jpg" alt="Aurora North">
                    </div>
                    <div class="image-container">
                        <h3 style="font-size: 16px; margin-bottom: 10px;">Southern Hemisphere</h3>
                        <img id="auroraSouth" src="https://services.swpc.noaa.gov/images/aurora-forecast-southern-hemisphere.jpg" alt="Aurora South">
                    </div>
                </div>
                <p class="info-text">Green/yellow indicates aurora visibility. Updates every 5 minutes.</p>
                <button class="refresh-btn" onclick="refreshAurora()">‚Üª Refresh Aurora</button>
            </div>

            <!-- Planetary K-index -->
            <div class="card">
                <h2>üåç Planetary K-index (3 Day)</h2>
                <div class="image-container">
                    <img id="kindex" src="https://services.swpc.noaa.gov/images/planetary-k-index.gif" alt="K-index">
                </div>
                <div class="legend">
                    <h4>K-index Scale:</h4>
                    <strong>Kp 0-2:</strong> Quiet ‚Ä¢ 
                    <strong>Kp 3-4:</strong> Unsettled ‚Ä¢ 
                    <strong>Kp 5:</strong> Minor Storm ‚Ä¢ 
                    <strong>Kp 6:</strong> Moderate Storm ‚Ä¢ 
                    <strong>Kp 7-9:</strong> Strong to Extreme Storm
                </div>
                <button class="refresh-btn" onclick="refreshKindex()">‚Üª Refresh K-index</button>
            </div>

            <!-- Solar Cycle Progression -->
            <div class="card card-full">
                <h2>‚òÄÔ∏è Solar Cycle 25 Progression</h2>
                <div class="image-container">
                    <img id="solarCycle" src="https://services.swpc.noaa.gov/images/solar-cycle-sunspot-number.gif" alt="Solar Cycle">
                </div>
                <p class="info-text">Current solar cycle showing sunspot numbers. Solar maximum expected around 2024-2025.</p>
                <button class="refresh-btn" onclick="refreshSolarCycle()">‚Üª Refresh Solar Cycle</button>
            </div>

            <!-- WSA-ENLIL Solar Wind -->
            <div class="card">
                <h2>üåä WSA-ENLIL Solar Wind Prediction</h2>
                <div class="image-container">
                    <img id="enlil" src="https://services.swpc.noaa.gov/images/animations/enlil/latest.jpg" alt="ENLIL Model">
                </div>
                <p class="info-text">3D model of solar wind and CME propagation. Shows density and speed of solar wind.</p>
                <button class="refresh-btn" onclick="refreshEnlil()">‚Üª Refresh ENLIL</button>
            </div>

            <!-- Dst Index -->
            <div class="card">
                <h2>üìä Dst Index (Current Month)</h2>
                <div class="image-container">
                    <img id="dst" src="https://wdc.kugi.kyoto-u.ac.jp/dst_realtime/presentmonth/index.png" alt="Dst Index">
                </div>
                <div class="legend">
                    <h4>Dst Index Interpretation:</h4>
                    <strong>Dst &gt; -30 nT:</strong> Quiet to Unsettled ‚Ä¢ 
                    <strong>-30 to -50 nT:</strong> Minor Storm ‚Ä¢ 
                    <strong>-50 to -100 nT:</strong> Moderate Storm ‚Ä¢ 
                    <strong>&lt; -100 nT:</strong> Intense Storm
                </div>
                <p class="info-text">Disturbance Storm Time index measures geomagnetic storm intensity. Lower values indicate stronger storms.</p>
                <button class="refresh-btn" onclick="refreshDst()">‚Üª Refresh Dst</button>
            </div>
        </div>

        <footer>
            <p><strong>Data Sources:</strong> 
                <a href="https://www.swpc.noaa.gov" target="_blank">NOAA Space Weather Prediction Center</a> ‚Ä¢ 
                <a href="https://wdc.kugi.kyoto-u.ac.jp" target="_blank">Kyoto University WDC</a>
            </p>
            <p style="margin-top: 10px;">This dashboard updates automatically. Images refresh based on source update frequencies.</p>
        </footer>
    </div>

    <script>
        // Auto-refresh intervals
        let xrayInterval;
        let imageInterval;

        // Load GOES X-ray Flux data
        async function loadXrayData() {
            const refreshBtn = document.querySelector('.card-full .refresh-btn');
            refreshBtn.disabled = true;
            refreshBtn.innerHTML = '<span class="spinning">‚Üª</span> Loading...';

            try {
                const response = await fetch('https://services.swpc.noaa.gov/json/goes/primary/xrays-6-hour.json');
                const jsonData = await response.json();

                const shortWave = [];
                const longWave = [];

                jsonData.forEach(d => {
                    if (d.flux !== -999 && d.flux > 0) {
                        const time = new Date(d.time_tag);
                        const flux = parseFloat(d.flux);
                        
                        if (d.energy === '0.05-0.4nm') {
                            shortWave.push({ x: time, y: flux });
                        } else if (d.energy === '0.1-0.8nm') {
                            longWave.push({ x: time, y: flux });
                        }
                    }
                });

                shortWave.sort((a, b) => a.x - b.x);
                longWave.sort((a, b) => a.x - b.x);

                plotXrayData(shortWave, longWave);
                updateTimestamp();

            } catch (error) {
                console.error('Error loading X-ray data:', error);
            }

            refreshBtn.disabled = false;
            refreshBtn.innerHTML = '‚Üª Refresh X-ray Data';
        }

        function plotXrayData(shortWave, longWave) {
            const trace1 = {
                x: shortWave.map(d => d.x),
                y: shortWave.map(d => d.y),
                type: 'scatter',
                mode: 'lines',
                name: '0.05-0.4 nm',
                line: { color: '#dc2626', width: 2 }
            };

            const trace2 = {
                x: longWave.map(d => d.x),
                y: longWave.map(d => d.y),
                type: 'scatter',
                mode: 'lines',
                name: '0.1-0.8 nm',
                line: { color: '#2563eb', width: 2 }
            };

            const layout = {
                xaxis: {
                    title: 'Time (UTC)',
                    showgrid: true,
                    gridcolor: '#e5e7eb'
                },
                yaxis: {
                    title: 'Watts / m¬≤',
                    type: 'log',
                    range: [-9, -2],
                    showgrid: true,
                    gridcolor: '#e5e7eb',
                    exponentformat: 'e'
                },
                hovermode: 'closest',
                shapes: [
                    { type: 'line', x0: shortWave[0]?.x, x1: shortWave[shortWave.length - 1]?.x, y0: 1e-4, y1: 1e-4, line: { color: '#dc2626', width: 1.5, dash: 'dash' } },
                    { type: 'line', x0: shortWave[0]?.x, x1: shortWave[shortWave.length - 1]?.x, y0: 1e-5, y1: 1e-5, line: { color: '#ea580c', width: 1.5, dash: 'dash' } },
                    { type: 'line', x0: shortWave[0]?.x, x1: shortWave[shortWave.length - 1]?.x, y0: 1e-6, y1: 1e-6, line: { color: '#eab308', width: 1.5, dash: 'dash' } },
                    { type: 'line', x0: shortWave[0]?.x, x1: shortWave[shortWave.length - 1]?.x, y0: 1e-7, y1: 1e-7, line: { color: '#16a34a', width: 1.5, dash: 'dash' } },
                    { type: 'line', x0: shortWave[0]?.x, x1: shortWave[shortWave.length - 1]?.x, y0: 1e-8, y1: 1e-8, line: { color: '#2563eb', width: 1.5, dash: 'dash' } }
                ],
                annotations: [
                    { x: 0.98, y: Math.log10(1e-4), xref: 'paper', yref: 'y', text: 'X', showarrow: false, font: { size: 12, color: '#dc2626' } },
                    { x: 0.98, y: Math.log10(1e-5), xref: 'paper', yref: 'y', text: 'M', showarrow: false, font: { size: 12, color: '#ea580c' } },
                    { x: 0.98, y: Math.log10(1e-6), xref: 'paper', yref: 'y', text: 'C', showarrow: false, font: { size: 12, color: '#eab308' } },
                    { x: 0.98, y: Math.log10(1e-7), xref: 'paper', yref: 'y', text: 'B', showarrow: false, font: { size: 12, color: '#16a34a' } },
                    { x: 0.98, y: Math.log10(1e-8), xref: 'paper', yref: 'y', text: 'A', showarrow: false, font: { size: 12, color: '#2563eb' } }
                ],
                margin: { l: 60, r: 40, t: 30, b: 50 },
                plot_bgcolor: '#ffffff',
                paper_bgcolor: '#ffffff'
            };

            const config = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['lasso2d', 'select2d']
            };

            Plotly.newPlot('xrayChart', [trace1, trace2], layout, config);
        }

        // Refresh functions for images
        function refreshAurora() {
            const north = document.getElementById('auroraNorth');
            const south = document.getElementById('auroraSouth');
            const timestamp = new Date().getTime();
            north.src = `https://services.swpc.noaa.gov/images/aurora-forecast-northern-hemisphere.jpg?t=${timestamp}`;
            south.src = `https://services.swpc.noaa.gov/images/aurora-forecast-southern-hemisphere.jpg?t=${timestamp}`;
            updateTimestamp();
        }

        function refreshKindex() {
            const img = document.getElementById('kindex');
            img.src = `https://services.swpc.noaa.gov/images/planetary-k-index.gif?t=${new Date().getTime()}`;
            updateTimestamp();
        }

        function refreshSolarCycle() {
            const img = document.getElementById('solarCycle');
            img.src = `https://services.swpc.noaa.gov/images/solar-cycle-sunspot-number.gif?t=${new Date().getTime()}`;
            updateTimestamp();
        }

        function refreshEnlil() {
            const img = document.getElementById('enlil');
            img.src = `https://services.swpc.noaa.gov/images/animations/enlil/latest.jpg?t=${new Date().getTime()}`;
            updateTimestamp();
        }

        function refreshDst() {
            const img = document.getElementById('dst');
            img.src = `https://wdc.kugi.kyoto-u.ac.jp/dst_realtime/presentmonth/index.png?t=${new Date().getTime()}`;
            updateTimestamp();
        }

        function updateTimestamp() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = 
                `Last updated: ${now.toLocaleString()} (Your Local Time)`;
        }

        // Initial load
        loadXrayData();
        updateTimestamp();

        // Auto-refresh: X-ray data every 2 minutes, images every 5 minutes
        xrayInterval = setInterval(loadXrayData, 120000);
        imageInterval = setInterval(() => {
            refreshAurora();
            refreshKindex();
        }, 300000);
    </script>
</body>
</html>
